/*!
 * Polos JS v1.6.1 - Production Version
 * Core: Responsive Grid, Screen Detection, Event System, Popup
 * Compatible with Polos CSS Framework
 * @copyright 2025 Polos Style - MIT License
 * @link : https://github.com/alicom13/polos
 */
class Polos{constructor(){this.version="1.6.1",this.breakpoints={small:"(max-width: 575.98px)",medium:"(min-width: 576px) and (max-width: 767.98px)",large:"(min-width: 768px)"},this.classes={loading:"lmn-loading",interactive:"js-inpolos",responsive:{show:{small:"d-sm",medium:"d-md",large:"d-lg"},hide:{small:"h-sm",medium:"h-md",large:"h-lg"}},popup:{wrapper:"popup",container:"pop",header:"pop-hd",title:"pop-title",body:"pop-bd",footer:"pop-ft",closeButton:"pop-close",button:"btn",sizePrefix:"pop-",type:{toast:"popup-toast",alertBox:"pop-alert"}}},this.defaults={animationDuration:300,closeOnBackdrop:!0,toastDuration:5e3},this.currentScreenSize="",this.observers=[],this.activePopups=new Set,this.init()}detectScreenSize(){const e=this.currentScreenSize;window.matchMedia(this.breakpoints.large).matches?this.currentScreenSize="large":window.matchMedia(this.breakpoints.medium).matches?this.currentScreenSize="medium":window.matchMedia(this.breakpoints.small).matches&&(this.currentScreenSize="small"),e!==this.currentScreenSize&&this.triggerEvent("screenChange",{from:e,to:this.currentScreenSize,columns:this.getCurrentColumns()})}getCurrentColumns(){return"large"===this.currentScreenSize?12:"medium"===this.currentScreenSize?8:4}getScreenSize(){return this.currentScreenSize}refresh(){this.detectScreenSize()}manageGrid(e,t){const s=document.querySelector(e);s&&(s.querySelectorAll('[class*="cl-"], [class*="cm-"], [class*="cs-"]').forEach(e=>{e.classList.forEach(t=>{/^(cl|cm|cs)-\d+$/.test(t)&&e.classList.remove(t)})}),t.forEach((e,t)=>{const o=s.children[t];o&&(e.large>=1&&e.large<=12&&o.classList.add("cl-"+e.large),e.medium>=1&&e.medium<=8&&o.classList.add("cm-"+e.medium),e.small>=1&&e.small<=4&&o.classList.add("cs-"+e.small))}))}show(e){document.querySelectorAll(e).forEach(e=>{const t=e.getAttribute("data-polos-original-display");e.style.display=t||""})}hide(e){document.querySelectorAll(e).forEach(e=>{if(!e.hasAttribute("data-polos-original-display")){const t=window.getComputedStyle(e);e.setAttribute("data-polos-original-display",t.display)}e.style.display="none"})}showOn(e,t){const s={small:"small",medium:"medium",large:"large"}[t];if(!s)return;const o=this.classes.responsive.show[s],i=this.classes.responsive.hide[s];document.querySelectorAll(e).forEach(e=>{e.classList.add(o),e.classList.remove(i)})}hideOn(e,t){const s={small:"small",medium:"medium",large:"large"}[t];if(!s)return;const o=this.classes.responsive.show[s],i=this.classes.responsive.hide[s];document.querySelectorAll(e).forEach(e=>{e.classList.add(i),e.classList.remove(o)})}setLoading(e,t,s=""){document.querySelectorAll(e).forEach(e=>{t?(e.classList.add(this.classes.loading),s&&e.setAttribute("data-polos-loading-text",s)):(e.classList.remove(this.classes.loading),e.hasAttribute("data-polos-loading-text")&&e.removeAttribute("data-polos-loading-text"))})}enhance(e){document.querySelectorAll(e).forEach(e=>{e.classList.add(this.classes.interactive)})}on(e,t=null){if("function"!=typeof e)return null;const s=t||"obs-"+Date.now()+"-"+Math.random().toString(36).substr(2,9);return this.observers.push({id:s,fn:e,timestamp:Date.now()}),s}off(e){let t=-1;return"function"==typeof e?t=this.observers.findIndex(t=>t.fn===e):"string"==typeof e&&(t=this.observers.findIndex(t=>t.id===e)),t>-1&&(this.observers.splice(t,1),!0)}triggerEvent(e,t){this.observers.forEach(s=>{"function"==typeof s.fn&&s.fn(e,t)})}_generatePopupId(e="popup-"){return e+Date.now()+"-"+Math.random().toString(36).substr(2,9)}popup(e={}){const t={title:"",content:"",size:"md",type:"default",alertType:"info",buttons:[{text:"OK",class:this.classes.popup.button+"-primary",action:"close"}],onClose:null,onOpen:null,onConfirm:null,closeOnBackdrop:this.defaults.closeOnBackdrop,...e},s=this._generatePopupId(),o=this.classes.popup;let i="";if("toast"===t.type)i=`<div class="${o.type.toast}" id="${s}">${t.content}</div>`;else if("alert"===t.type)i=`<div class="${o.wrapper}" id="${s}"><div class="${o.container} ${o.sizePrefix}sm"><div class="${o.body}"><div class="${o.type.alert} ${t.alertType}">${t.content}</div></div><div class="${o.footer}"><button class="${o.button}-primary" data-polos="close">OK</button></div></div></div>`;else if("confirm"===t.type)i=`<div class="${o.wrapper}" id="${s}"><div class="${o.container} ${o.sizePrefix}sm"><div class="${o.body}"><div class="${o.type.alert} ${t.alertType||"info"}">${t.content}</div></div><div class="${o.footer}"><button class="${o.button}-secondary" data-polos="close">Batal</button><button class="${o.button}-primary" data-polos="confirm">OK</button></div></div></div>`;else{const e=t.title?`<button class="${o.closeButton}" data-polos="close">&times;</button>`:"",n=t.title?`<div class="${o.header}"><h3 class="${o.title}">${t.title}</h3>${e}</div>`:"",a=t.buttons.map(e=>`<button class="${e.class}" data-polos="close">${e.text}</button>`).join(""),r=t.buttons.length>0?`<div class="${o.footer}">${a}</div>`:"";i=`<div class="${o.wrapper}" id="${s}"><div class="${o.container} ${o.sizePrefix}${t.size}">${n}<div class="${o.body}">${t.content}</div>${r}</div></div>`}return document.body.insertAdjacentHTML("beforeend",i),document.getElementById(s)._popupOptions=t,t.onOpen&&t.onOpen(),this.activePopups.add(s),s}openPopup(e){const t=document.getElementById(e);if(t){if(t.classList.add("active"),document.body.style.overflow="hidden",t.classList.contains(this.classes.popup.type.toast)){const s=t._popupOptions&&t._popupOptions.duration?t._popupOptions.duration:this.defaults.toastDuration;setTimeout(()=>this.closePopup(e),s)}this.triggerEvent("popupOpened",{popupId:e})}}closePopup(e){const t=document.getElementById(e);t&&(t.classList.remove("active"),this.activePopups.delete(e),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),0===this.activePopups.size&&(document.body.style.overflow=""),t._popupOptions&&t._popupOptions.onClose&&t._popupOptions.onClose()},this.defaults.animationDuration),this.triggerEvent("popupClosed",{popupId:e}))}closeAllPopups(){this.activePopups.forEach(e=>this.closePopup(e))}alert(e,t="info",s=""){const o=s?`<h4 style="margin-bottom:0.5rem">${s}</h4><p>${e}</p>`:`<p>${e}</p>`,i=this.popup({type:"alert",alertType:t,content:o});return this.openPopup(i),i}confirm(e,t,s=null){const o=this.popup({type:"confirm",content:e,onConfirm:t,onClose:s});return this.openPopup(o),o}toast(e,t=3e3){const s=this.popup({type:"toast",content:e,duration:t});return this.openPopup(s),s}debug(){return{version:this.version,screenSize:this.currentScreenSize,columns:this.getCurrentColumns(),observers:this.observers.length,activePopups:this.activePopups.size,classes:this.classes}}init(){let e;this.detectScreenSize(),window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>this.detectScreenSize(),100)}),this.triggerEvent("initialized",{version:this.version,timestamp:(new Date).toISOString()}),window.addEventListener("beforeunload",()=>{this.closeAllPopups()}),document.addEventListener("click",e=>{const t=e.target.closest("[data-polos]");if(!t)return;const s=t.dataset.polos,o=t.dataset.polosTarget,i=t.dataset.polosClass;switch(s){case"popup":o&&this.openPopup(o.replace("#",""));break;case"close":const e=t.closest("."+this.classes.popup.wrapper);e&&this.closePopup(e.id);break;case"confirm":const n=t.closest("."+this.classes.popup.wrapper);n&&n._popupOptions.onConfirm&&n._popupOptions.onConfirm(),n&&this.closePopup(n.id);break;case"toggle-class":if(o){const e=document.querySelector(o);e&&i&&e.classList.toggle(i)}}})}}const PolosInstance=new Polos;"undefined"!=typeof window&&(window.Polos=PolosInstance),"undefined"!=typeof module&&module.exports&&(module.exports=Polos);
