/*!
 * Polos DOM (p$) Plugin v2.0.9 - Final Production
 * Lightweight, Chainable DOM utilities with Polos integration
 * Requires Polos JS v1.6.1+
 * Â© 2025 Polos Style - MIT License 
 */
!function(e){"use strict";if("function"==typeof e.p$&&"2.1.0"===e.p$._version)return;const t="undefined"!=typeof window&&"undefined"!=typeof document,n=t&&!0===window.__POLOS_DEV__,r=()=>{const e={on:()=>t,off:()=>t,one:()=>t,addClass:()=>t,removeClass:()=>t,toggleClass:()=>t,hasClass:()=>!1,attr:()=>{},css:()=>{},html:()=>"",text:()=>"",val:()=>{},append:()=>t,prepend:()=>t,remove:()=>t,empty:()=>t,find:()=>t,parent:()=>t,children:()=>t,first:()=>t,last:()=>t,eq:()=>t,each:()=>t,map:()=>[],filter:()=>t,is:()=>!1,show:()=>t,hide:()=>t,data:()=>{},removeAttr:()=>t,polosShowOn:()=>t,polosHideOn:()=>t,polosSetLoading:()=>t,polosPopup:()=>null,__isNullChain:!0},t=Object.freeze(Object.create(e));return t._el=[],t._length=0,new Proxy(t,{get:(e,t)=>t in e?e[t]:"string"==typeof t?t.startsWith("polos")||t.startsWith("_")?()=>(n&&console.warn(`p$: Method "${t}" not available`),e):()=>e:e[t]})},o=Symbol("polos.events"),i={count:0},l={init:e=>(e[o]||(e[o]={handlers:new Map,idCounter:0}),e[o]),_createHandlerKey(e,t){const n=`${i.count++}_${Date.now()}_${Math.random().toString(36).slice(2,9)}`;return`${e.name||"anonymous"}_${n}_${t?JSON.stringify(t):"default"}`.slice(0,100)},add(e,t,n,r,o={}){const i=this.init(e),l=i.handlers.get(t)||new Map,s=this._createHandlerKey(n,o),c={original:n,wrapped:r,options:o,key:s,id:n.__p$eventId||Symbol(`event-${t}`)};return n.__p$eventKey=s,n.__p$eventElement=e,l.set(s,c),i.handlers.set(t,l),e.addEventListener(t,r,o),s},remove(e,t,n,r={}){const i=e[o];if(!i)return!1;const l=i.handlers.get(t);if(!l)return!1;let s=!1;if(n){const o=[];for(const[e,t]of l.entries())(t.original===n||n.__p$eventKey&&n.__p$eventKey===e||r&&JSON.stringify(t.options)===JSON.stringify(r))&&o.push(e);for(const n of o){const r=l.get(n);r&&(e.removeEventListener(t,r.wrapped,r.options),l.delete(n),s=!0)}}else{for(const[n,r]of l.entries())e.removeEventListener(t,r.wrapped,r.options),l.delete(n);s=!0}return 0===l.size&&i.handlers.delete(t),0===i.handlers.size&&delete e[o],s},clear(e){const t=e[o];if(t){for(const[n,r]of t.handlers.entries())for(const[t,o]of r.entries())e.removeEventListener(n,o.wrapped,o.options);delete e[o]}}},s=e=>Array.from(e||[]),c=e=>"function"==typeof e,a=e=>"string"==typeof e,p=e=>e&&"number"==typeof e.nodeType,u=function(e){if(!t)return r();const o=new WeakSet,i=[],l=e=>{if(e)if(e instanceof u)e._el.forEach(l);else if(1!==e.nodeType&&e!==window&&e!==document)if(void 0===e.length)n&&console.warn("p$: Unsupported selector type:",typeof e,e);else for(let t=0;t<e.length;t++){const r=e[t];r&&(1===r.nodeType||r instanceof u)?l(r):n&&r&&!r.nodeType&&console.warn("p$: Invalid element in collection at index",t,r)}else o.has(e)||(o.add(e),i.push(e))};return l(e),this._el=i,this._length=i.length,0===this._length?r():void 0},h=e=>function(...r){this._el=this._el.filter(e=>p(e)&&(!t||document.contains(e))),this._length=this._el.length;for(const t of this._el)try{e(t,...r)}catch(e){n&&console.warn("p$: Error in method execution:",e)}return this},f=e=>function(...n){if(0===this._length)return;const r=this._el[0];return!r||t&&!document.contains(r)?void 0:e(r,...n)};function d(e){if(!t)return r();if(null==e)return r();if(a(e)&&""===e.trim())return r();if(a(e))try{const t=document.querySelectorAll(e);return new u(t)}catch(t){return n&&console.warn("p$: Invalid selector:",e,t),r()}if(e instanceof u)return e;if(p(e)||e===window||e===document)return new u([e]);if(e&&"object"==typeof e&&"length"in e){if(Array.from(e).every(e=>p(e)||e===window||e===document||e instanceof u))return new u(e);n&&console.warn("p$: Invalid collection - contains non-DOM elements")}if(e&&e.jquery)try{return new u(e.toArray())}catch(e){n&&console.warn("p$: jQuery conversion failed:",e)}return r()}u.prototype.on=function(e,t,r={}){return c(t)?h((e,t,r,o)=>{l.add(e,t,r,t=>{try{r.call(e,t)}catch(e){n&&console.error("p$: Event handler error:",e)}},o)}).call(this,e,t,r):this},u.prototype.off=function(e,t,n={}){return h((e,t,n,r)=>{l.remove(e,t,n,r)}).call(this,e,t,n)},u.prototype.one=function(e,t,n={}){return c(t)?h((e,t,n,r)=>{l.add(e,t,n,o=>{try{n.call(e,o)}finally{l.remove(e,t,n,r)}},{...r,once:!0})}).call(this,e,t,n):this},u.prototype.val=function(e){if(void 0===e){if(0===this._length)return;if(1===this._length){const e=this._el[0];return e.matches("select[multiple]")?s(e.selectedOptions).map(e=>e.value):"checkbox"===e.type||"radio"===e.type?e.checked?e.value:"":"value"in e?e.value:""}const e=[],t=new Set;return this._el.forEach(n=>{if("checkbox"===n.type&&n.name){const r=`checkbox_${n.name}`;if(!t.has(r)&&n.checked){const o=this._el.filter(e=>e.name===n.name&&e.checked).map(e=>e.value);e.push(...o),t.add(r)}}else if("radio"===n.type&&n.name&&n.checked){const r=`radio_${n.name}`;t.has(r)||(e.push(n.value),t.add(r))}else("checkbox"===n.type&&!n.name&&n.checked||"value"in n&&!n.name)&&e.push(n.value)}),e}return h((e,t)=>{if(e.matches("select[multiple]")){const n=Array.isArray(t)?t:[t];return void s(e.options).forEach(e=>{e.selected=n.includes(e.value)})}"checkbox"!==e.type&&"radio"!==e.type?"value"in e&&(e.value=null!=t?String(t):""):Array.isArray(t)?e.checked=t.includes(e.value):e.checked=e.value===String(t)||!0===t}).call(this,e)},u.prototype.html=function(e){return void 0===e?f(e=>e.innerHTML).call(this):h((e,t)=>{e.innerHTML=t}).call(this,e)},u.prototype.text=function(e){return void 0===e?f(e=>e.textContent).call(this):h((e,t)=>{e.textContent=t}).call(this,e)},u.prototype.attr=function(e,t){return void 0===t?f(t=>t.getAttribute(e)).call(this):h((e,t,n)=>{null!=n?e.setAttribute(t,n):e.removeAttribute(t)}).call(this,e,t)},u.prototype.css=function(e,t){return void 0===t&&"string"==typeof e?f(t=>getComputedStyle(t)[e]).call(this):h((e,t,n)=>{"object"==typeof t?Object.assign(e.style,t):e.style[t]=n}).call(this,e,t)},u.prototype.addClass=function(e){return h((e,t)=>{e.classList.add(t)}).call(this,e)},u.prototype.removeClass=function(e){return h((e,t)=>{e.classList.remove(t)}).call(this,e)},u.prototype.hasClass=function(e){return f(t=>t.classList.contains(e)).call(this)},u.prototype.remove=function(){return h(e=>{l.clear(e),e.parentNode&&e.parentNode.removeChild(e)}).call(this)},u.prototype.append=function(e){return h(t=>{"string"==typeof e?t.insertAdjacentHTML("beforeend",e):e instanceof u?e._el.forEach(e=>t.appendChild(e.cloneNode(!0))):e&&e.nodeType&&t.appendChild(e.cloneNode(!0))}).call(this,e)},u.prototype.prepend=function(e){return h(t=>{"string"==typeof e?t.insertAdjacentHTML("afterbegin",e):e instanceof u?e._el.reverse().forEach(e=>t.insertBefore(e.cloneNode(!0),t.firstChild)):e&&e.nodeType&&t.insertBefore(e.cloneNode(!0),t.firstChild)}).call(this,e)},u.prototype.empty=function(){return h(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)}).call(this)},u.prototype.find=function(e){if(0===this._length)return r();const t=[];return this._el.forEach(n=>{const r=n.querySelectorAll(e);t.push(...s(r))}),new u(t)},u.prototype.parent=function(){if(0===this._length)return r();const e=[];return this._el.forEach(t=>{t.parentNode&&e.push(t.parentNode)}),new u(e)},u.prototype.children=function(){if(0===this._length)return r();const e=[];return this._el.forEach(t=>{e.push(...s(t.children))}),new u(e)},u.prototype.first=function(){return 0===this._length?r():new u([this._el[0]])},u.prototype.last=function(){return 0===this._length?r():new u([this._el[this._length-1]])},u.prototype.eq=function(e){return 0===this._length||e>=this._length||e<0?r():new u([this._el[e]])},u.prototype.each=function(e){return c(e)?(this._el.forEach((t,r)=>{try{e.call(t,r,t)}catch(e){n&&console.warn("p$: Error in each callback:",e)}}),this):this},u.prototype.map=function(e){return c(e)?this._el.map((t,r)=>{try{return e.call(t,r,t)}catch(e){return n&&console.warn("p$: Error in map callback:",e),null}}):[]},u.prototype.filter=function(e){if(0===this._length)return r();const t=this._el.filter(t=>{if(c(e))try{return e.call(t,t)}catch(e){return n&&console.warn("p$: Error in filter callback:",e),!1}return t.matches(e)});return new u(t)},u.prototype.is=function(e){if(0===this._length)return!1;const t=this._el[0];if(c(e))try{return e.call(t,t)}catch(e){return n&&console.warn("p$: Error in is callback:",e),!1}return t.matches(e)},u.prototype.show=function(){return h(e=>{e.style.display=""}).call(this)},u.prototype.hide=function(){return h(e=>{e.style.display="none"}).call(this)},u.prototype.data=function(e,t){return void 0===t&&"string"==typeof e?f(t=>t.dataset[e]).call(this):"object"==typeof e?h((e,t)=>{Object.entries(t).forEach(([t,n])=>{e.dataset[t]=n})}).call(this,e):h((e,t,n)=>{null==n?delete e.dataset[t]:e.dataset[t]=n}).call(this,e,t)},u.prototype.removeAttr=function(e){return h((e,t)=>{e.removeAttribute(t)}).call(this,e)},d.create=function(e,n={}){if(!t)return r();const o=document.createElement(e);return Object.entries(n).forEach(([e,t])=>{if("class"===e)o.className=t;else if("html"===e)o.innerHTML=t;else if("text"===e)o.textContent=t;else if(e.startsWith("on")&&c(t)){const n=e.slice(2);o.addEventListener(n,t)}else null!=t&&o.setAttribute(e,String(t))}),d(o)},d.ready=function(e){t&&c(e)&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",e,{once:!0}):setTimeout(e,0))},d.cleanup=function(e){e&&l.clear(e)},d.getEventHandlers=function(e,t){if(!e||!e[o])return[];const n=e[o];return t?Array.from(n.handlers.get(t)?.keys()||[]):Array.from(n.handlers.keys())},d.noConflict=function(){return e._p$legacy&&(e.p$=e._p$legacy,delete e._p$legacy),d},t&&(e.p$&&e.p$._version&&(e._p$legacy=e.p$),e.p$=d,e.p$._version="2.1.0",n&&(d._debug={EventRegistry:l,isNullChain:e=>e&&!0===e.__isNullChain}))}("undefined"!=typeof window?window:this);